<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Compute Frameworks - mloda docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Compute Frameworks";
        var mkdocs_page_input_path = "chapter1/compute-frameworks.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> mloda docs
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../..">mloda</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Introduction Notebooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Basics</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../examples/mloda_basics/0_table_of_content/">Table of Content</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../examples/mloda_basics/1_ml_mloda_intro/">Intro to the core interfaces of mloda</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../examples/mloda_basics/2_ml_advantage_process_focus/">What makes mloda unique?</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../examples/mloda_basics/3_ml_data_feature_feature_groups/">Data, Feature, FeatureSets and FeatureGroups in mloda</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../examples/mloda_basics/4_ml_data_producers_user_owner/">Data Producer, User, Owner in mloda</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-request/">API Request</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../feature-groups/">Feature Groups</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Compute Frameworks</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-key-use-cases">1. Key Use Cases</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-balancing-flexibility-and-complexity">2. Balancing Flexibility and Complexity</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-example-without-a-specified-compute-framework">3. Example Without a Specified Compute Framework</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-design-options">4. Design options</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#part-of-api-request">Part of API request</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#specific-feature-configuration">Specific feature configuration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#defining-the-compute-framework-in-a-feature-group">Defining the Compute Framework in a Feature Group</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-summary">5. Summary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../extender/">Extender</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">In Depth - Basics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/mloda-api/">mloda API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/access-feature-data/">(Feature) data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/join_data/">Join data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/filter_data/">Filter data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/artifacts/">Artifacts</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">In Depth - Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/data-quality/">Data quality</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../in_depth/domain/">Domain concept</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../development/">Contributers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../license/">License - Apache 2.0</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../missing/">Missing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Need Help?</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../need-help/">Need Help</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">mloda docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Getting Started</li>
      <li class="breadcrumb-item active">Compute Frameworks</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="compute-framework">Compute Framework</h2>
<p>In the previous examples, you may have noticed that we used the following parameter in the mlodaAPI call: <strong>compute_frameworks=["PyarrowTable"]</strong>. Let’s take a moment to dive into this concept.</p>
<p>The Compute Framework is the second critical plugin in mloda, after the feature group. It is responsible for holding the state of the data and defining the technology used to execute operations.</p>
<h4 id="1-key-use-cases">1. Key Use Cases</h4>
<p>The compute framework concept provides significant flexibility and enables a variety of use cases, such as:</p>
<ul>
<li>Online and Offline Computation: Seamlessly switch between real-time and batch computations.</li>
<li>Testing: Easily compare different compute technologies or frameworks.</li>
<li>Migrations: Move from one environment to another (e.g., local to cloud or db to other db) without changing the underlying feature definitions.</li>
</ul>
<p>This flexibility is one of mloda’s key advantages, allowing users to decouple feature definitions from specific computation technologies—something that traditional feature stores don’t easily offer.</p>
<h4 id="2-balancing-flexibility-and-complexity">2. Balancing Flexibility and Complexity</h4>
<p>However, this flexibility introduces a bit of complexity. Let's look at an example where we remove the compute_frameworks=["PyarrowTable"] parameter from the mlodaAPI call.</p>
<h4 id="3-example-without-a-specified-compute-framework">3. Example Without a Specified Compute Framework</h4>
<pre><code class="language-python">from mloda_core.api.request import mlodaAPI
from mloda_core.abstract_plugins.components.data_access_collection import DataAccessCollection

file_path = &quot;tests/test_plugins/feature_group/src/dataset/creditcard_2023_short.csv&quot;
data_access_collection = DataAccessCollection(files={file_path})

feature_list = [&quot;id&quot;,&quot;V1&quot;,&quot;V2&quot;,&quot;V3&quot;]
</code></pre>
<p>Expected Error when running.</p>
<pre><code class="language-python">mlodaAPI.run_all(
    feature_list,       
    data_access_collection=data_access_collection
)

ValueError: Multiple feature groups 
{&lt;class 'ReadCsv'&gt;: {&lt;class 'PyarrowTable'&gt;}, 
&lt;class 'ReadCsvPandas'&gt;: {&lt;class 'PandasDataframe'&gt;}
.... found for feature name: id.
</code></pre>
<p>In this case, the framework finds multiple feature groups (like <strong>ReadCsv</strong> and <strong>ReadCsvPandas</strong>) that can handle the same file, but use different compute frameworks (<strong>PyarrowTable</strong> vs. <strong>PandasDataframe</strong>). Without explicitly specifying a compute framework, mloda doesn't know which one to use, leading to ambiguity.</p>
<p>This might seem counterintuitive, but it’s actually a <strong>feature</strong>, allowing you to compare different technologies and computation methods, particularly useful in scenarios such as:</p>
<ul>
<li><strong>Migrations</strong>: Moving from one environment to another.</li>
<li><strong>Scaling Projects</strong>: Upleveling a project from MVP to production.</li>
<li><strong>ML Lifecycle</strong>: Using the same KPIs (feature groups) across training, real-time inference, and model evaluation.</li>
</ul>
<h4 id="4-design-options">4. Design options</h4>
<p>There are several ways to resolve this ambiguity by explicitly defining the compute framework:</p>
<ul>
<li><strong>Using specific feature configuration</strong> to define compute frameworks for individual features.</li>
<li><strong>Within the feature group definition</strong>, by enforcing a specific compute framework rule.</li>
<li><strong>As part of the API request</strong> (as shown in previous examples).</li>
</ul>
<h5 id="part-of-api-request">Part of API request</h5>
<h5 id="specific-feature-configuration">Specific feature configuration</h5>
<p>You can configure individual features to use a specific compute framework. Here’s how to specify that a feature should use the PyarrowTable framework:</p>
<pre><code class="language-python">from mloda_core.abstract_plugins.components.feature import Feature

feature = Feature(&quot;id&quot;, options={&quot;compute_framework&quot;: &quot;PyarrowTable&quot;})

result = mlodaAPI.run_all(
    [feature], 
    data_access_collection=data_access_collection
)
result[0]
</code></pre>
<p>Expected output:</p>
<pre><code class="language-python">pyarrow.Table
id: int64
id: [[0,1,2,3,...]]
</code></pre>
<h5 id="defining-the-compute-framework-in-a-feature-group">Defining the Compute Framework in a Feature Group</h5>
<p>In this example, we define a compute framework rule inside the feature group. This ensures that the feature group can only run on a <strong>PyarrowTable</strong>. We also specify that the input feature should use <strong>PandasDataframe</strong>, allowing automatic conversion from <strong>PandasDataframe</strong> to <strong>PyarrowTable</strong> behind the scenes.</p>
<pre><code class="language-python">import pyarrow.compute as pc
import pyarrow as pa

from mloda_plugins.compute_framework.base_implementations.pyarrow.table import PyarrowTable
from mloda_plugins.compute_framework.base_implementations.pandas.dataframe import PandasDataframe
from mloda_core.abstract_plugins.abstract_feature_group import AbstractFeatureGroup


class ExampleB(AbstractFeatureGroup):

    @classmethod
    def compute_framework_rule(cls):
            return {PyarrowTable}
    def input_features(self, option, feature_name):
        return {Feature(name=feature_name.name.split(&quot;_&quot;)[1], 
                compute_framework=&quot;PandasDataframe&quot;)}

    @classmethod
    def calculate_feature(cls, data, _):
        multiplied_columns = [pc.multiply(data[column], 2) for column in data.column_names]
        col_names = [f&quot;{cls.get_class_name()}_{col_names}&quot; for col_names in data.column_names]
        multiplied_table = pa.table(multiplied_columns, names=col_names)
        return multiplied_table
</code></pre>
<p>Running the ExampleB Feature Group</p>
<pre><code class="language-python">example_feature_list = [f&quot;ExampleB_{f}&quot; for f in feature_list]

result = mlodaAPI.run_all(
    example_feature_list,
    compute_frameworks={PyarrowTable, PandasDataframe},
    data_access_collection=data_access_collection,
)
result[0]
</code></pre>
<p>In this case, the feature group ExampleB will only run on the PyarrowTable framework, while the input feature group uses PandasDataframe, ensuring that the framework correctly handles the conversion between these technologies.</p>
<h4 id="5-summary">5. Summary</h4>
<p>mloda's compute framework adds flexibility, allowing you to select the best tool for different stages of data and feature engineering. While it introduces some complexity, it’s invaluable for comparing technologies and managing environments.</p>
<p>That said, <strong>you can configure mloda to use just one compute framework</strong> for a more familiar workflow, similar to traditional feature stores, data pipelines, or ETL systems. Whether you prefer flexibility or simplicity, mloda adapts to your needs while ensuring consistent feature processing.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../feature-groups/" class="btn btn-neutral float-left" title="Feature Groups"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../extender/" class="btn btn-neutral float-right" title="Extender">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../feature-groups/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../extender/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
